// Generated by Copilot
import { buildHealthChartSeries, ABNORMAL_COLOR } from '../healthChart';

describe('buildHealthChartSeries', () => {
  it('flags abnormal blood pressure points on shared axis', () => {
    const { timeAxis, systolicData, diastolicData, heartRateData, yMin, yMax } = buildHealthChartSeries([
      {
        timestamp: '2025-09-26T02:00:00Z',
        systolic: 130,
        diastolic: 85,
        heart_rate: 70,
      },
      {
        timestamp: '2025-09-26T03:00:00Z',
        systolic: 115,
        diastolic: 75,
        heart_rate: 60,
      },
    ]);

    expect(timeAxis[0]).not.toEqual('');
    expect(systolicData[0]).toMatchObject({
      itemStyle: { color: ABNORMAL_COLOR },
    });
    expect(diastolicData[0]).toMatchObject({
      itemStyle: { color: ABNORMAL_COLOR },
    });
    expect(systolicData[1]).toBe(115);
    expect(diastolicData[1]).toBe(75);
    expect(heartRateData[0]).toBe(70);
    expect(yMax).toBeGreaterThanOrEqual(130);
    expect(yMin).toBeLessThanOrEqual(60);
  });

  it('returns empty arrays when no data is provided', () => {
    const result = buildHealthChartSeries();
    expect(result.timeAxis).toEqual([]);
    expect(result.systolicData).toEqual([]);
    expect(result.diastolicData).toEqual([]);
    expect(result.heartRateData).toEqual([]);
  });
});
