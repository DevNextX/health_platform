# 健康记录平台 MVP 需求文档

> 实现状态（MVP-1, 2025-08-28）
>
> - 用户管理：已实现（注册/登录/登出、邮箱唯一性校验、JWT 会话、个人信息编辑）。
> - 健康数据录入：已实现（收缩压/舒张压范围 50-250 校验、心率可选、备注、标签多选、时间戳、倒序列表、按标签与日期筛选）。
> - 数据可视化：已实现（血压/心率折线图，支持最近一周/一月/全部切换，表格视图一致，图表下载为图片）。
> - 分享与导出：MVP 阶段提供图表下载（已实现）；CSV 导出与在线分享链接（未实现）。
> - 其他要求：响应式设计（已实现）；数据安全与隐私（JWT、限流、CORS，已落实基础措施）。
>
> 说明：前端字段与后端契约统一为 systolic/diastolic/heart_rate/note/timestamp/tags，仪表盘平均血压与趋势图基于该数据源计算与展示。
>
> Generated by Zhuang

## 一、需求概述

本平台旨在为用户提供便捷的健康数据记录与管理服务，支持多用户独立登录，记录血压、心跳等健康指标，并通过标签和时间筛选，生成清晰的趋势报表。平台支持报表图片下载，方便用户就医时与医生分享。未来将扩展家庭成员管理、数据导出、微信小程序接入及聊天查询等功能。

---

## 二、功能模块需求

### 1. 用户管理
#### 功能模块描述
- 用户注册时需填写用户名、密码、邮箱（邮箱唯一），可选填写年龄、性别、体重等信息。
- 支持邮箱+密码登录，安全登出。
- 用户可编辑个人信息（昵称、头像、年龄、性别、体重）。
- 多用户数据独立，后续支持家庭成员邀请与管理。

#### 验收标准
- 注册时邮箱唯一性校验，重复邮箱注册失败。
- 登录、登出流程无异常，支持会话管理。
- 用户信息编辑后可即时保存并展示。
- 不同用户间数据互不影响。

实现情况（MVP-1）：
- 已提供 /api/v1/auth/register、/login、/logout、/refresh 等接口，前端完成登录/注册页与个人信息页；使用 JWT 进行鉴权并集成刷新令牌；邮箱唯一校验已在后端与测试覆盖。

#### 边界情况
- 注册时邮箱重复、密码弱、必填项缺失等异常处理。
- 用户信息编辑时字段为空或格式错误。

---

### 2. 健康数据录入
#### 功能模块描述
- 支持录入血压（收缩压/舒张压，范围50-250）、心跳。
- 自动记录时间戳，允许手动修改。
- 可填写备注。
- 支持选择或新建多个标签（如“晨起”、“运动后”、“服药前”等）。
- 历史记录按时间倒序展示，支持按日期和标签筛选。

#### 验收标准
- 血压录入范围校验，超出范围提示错误。
- 标签可多选、可新建，录入后可筛选。
- 时间戳自动生成，手动修改有效。
- 历史数据展示正确，筛选功能可用。

实现情况（MVP-1）：
- 已实现健康记录 CRUD，字段：systolic、diastolic、heart_rate、timestamp、tags、note。
- 范围校验（50-250）已在后端约束；前端表单含校验并以 mmHg/bpm 展示。
- 列表支持分页、标签筛选与日期范围（date_from/date_to）筛选，时间倒序展示。

#### 边界情况
- 血压录入超出范围、标签重复创建、数据筛选无结果等。

---

### 3. 数据可视化
#### 功能模块描述
- 折线图展示血压、心跳趋势，重点突出最近一周每天8:00、12:00、20:00的数据变化。
- 支持切换时间范围（如本周、本月）。
- 表格视图展示原始数据。
- 支持按标签分组和筛选趋势。

#### 验收标准
- 折线图数据与原始数据一致，关键时间点突出显示。
- 时间范围切换无误，标签筛选有效。
- 表格视图完整展示原始数据。
- 报表可下载为图片，图片内容与页面一致。

实现情况（MVP-1）：
- 仪表盘显示总记录、本周记录、平均收缩压/舒张压/心率；血压与趋势图已统一使用 systolic/diastolic 字段。
- 趋势图支持最近一周、最近一月、全部；支持图表下载为 PNG。

#### 边界情况
- 网络异常、数据量过大导致报表渲染缓慢。

---

### 4. 分享与导出
#### 功能模块描述
- MVP阶段支持报表一键截图或图片下载。
- 未来扩展支持CSV导出、生成医生在线查看链接。

#### 验收标准
- 报表下载功能可用，图片清晰完整。
- 分享入口设计合理，交互流畅。

实现情况（MVP-1）：
- 提供图表下载功能（已实现）。
- CSV 导出与在线分享链接为后续扩展（未实现）。

#### 边界情况
- 用户数据泄露风险，需加密存储与权限控制。
- 报表展示性能瓶颈，需优化数据查询与前端渲染。

---

### 5. 其他功能与技术要求

- 响应式设计，适配手机和电脑
- 数据安全与隐私保护
- 简洁易用的界面
- 标签系统支持自定义和管理

### 6. 未来扩展方向

- 微信小程序接入
- 支持通过聊天（如微信/平台内聊天）查询和筛选健康记录

Generated by Zhuang
